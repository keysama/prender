!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";module.exports=class{constructor(t){this.maxCall=t,this._queue=[]}push(t,e=null){this._queue.push({fn:t,res:null,status:"block",index:this._queue.length,context:e})}async run(){let e=[];for(let t=0;t<this.maxCall;t++)e.push(this.runOne());return await Promise.all(e),this._queue.sort((t,e)=>t.index-e.index).map(t=>t.res)}async runOne(){let t=this._queue.filter(t=>"block"===t.status)[0];return!t||(t.status="running",t.res=await t.fn.call(t.context),t.status="finish",this.runOne())}}});
