{"version":3,"file":"server.js","sources":["../../src/server.js"],"sourcesContent":["const Koa = require(\"koa\");\nconst koaStatic = require(\"koa-static\");\nconst Router = require(\"koa-router\");\nconst path = require(\"path\");\nconst fs = require(\"fs\");\n\nclass Server {\n    constructor({ port = 8910, staticPath = path.join(__dirname,\"./target\") }){\n      this.port = port;\n      this.staticPath = staticPath;\n      this._app = new Koa();\n      this._nativeServer = null;\n      this._router = new Router();\n    }\n  \n    async initialize(){\n      return new Promise(resolve => {\n        this._app.use(koaStatic(path.resolve(this.staticPath)));\n        this._router.get(/.*/, async (ctx, next) => {\n          ctx.type = 'html';\n          ctx.body = fs.createReadStream(path.join(this.staticPath,\"./index.html\"));\n          await next();\n        })\n        this._app.use(this._router.routes());\n        this._app.use(this._router.allowedMethods());\n        this._nativeServer = this._app.listen(this.port,resolve);\n      })\n    }\n  \n    destroy () {\n      this._nativeServer.close()\n    }\n}\n\nmodule.exports = Server;"],"names":["Koa","require","koaStatic","Router","path","fs","Server","constructor","port","staticPath","join","__dirname","_app","_nativeServer","_router","initialize","Promise","resolve","use","get","ctx","next","type","body","createReadStream","routes","allowedMethods","listen","destroy","close","module","exports"],"mappings":";;;;;EAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAD,CAAnB;;EACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,YAAD,CAAzB;;EACA,MAAME,MAAM,GAAGF,OAAO,CAAC,YAAD,CAAtB;;EACA,MAAMG,IAAI,GAAGH,OAAO,CAAC,MAAD,CAApB;;EACA,MAAMI,EAAE,GAAGJ,OAAO,CAAC,IAAD,CAAlB;;EAEA,MAAMK,MAAN,CAAa;EACTC,EAAAA,WAAW,CAAC;EAAEC,IAAAA,IAAI,GAAG,IAAT;EAAeC,IAAAA,UAAU,GAAGL,IAAI,CAACM,IAAL,CAAUC,SAAV,EAAoB,UAApB;EAA5B,GAAD,EAA+D;EACxE,SAAKH,IAAL,GAAYA,IAAZ;EACA,SAAKC,UAAL,GAAkBA,UAAlB;EACA,SAAKG,IAAL,GAAY,IAAIZ,GAAJ,EAAZ;EACA,SAAKa,aAAL,GAAqB,IAArB;EACA,SAAKC,OAAL,GAAe,IAAIX,MAAJ,EAAf;EACD;;EAEe,QAAVY,UAAU,GAAE;EAChB,WAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;EAC5B,WAAKL,IAAL,CAAUM,GAAV,CAAchB,SAAS,CAACE,IAAI,CAACa,OAAL,CAAa,KAAKR,UAAlB,CAAD,CAAvB;;EACA,WAAKK,OAAL,CAAaK,GAAb,CAAiB,IAAjB,EAAuB,OAAOC,GAAP,EAAYC,IAAZ,KAAqB;EAC1CD,QAAAA,GAAG,CAACE,IAAJ,GAAW,MAAX;EACAF,QAAAA,GAAG,CAACG,IAAJ,GAAWlB,EAAE,CAACmB,gBAAH,CAAoBpB,IAAI,CAACM,IAAL,CAAU,KAAKD,UAAf,EAA0B,cAA1B,CAApB,CAAX;EACA,cAAMY,IAAI,EAAV;EACD,OAJD;;EAKA,WAAKT,IAAL,CAAUM,GAAV,CAAc,KAAKJ,OAAL,CAAaW,MAAb,EAAd;;EACA,WAAKb,IAAL,CAAUM,GAAV,CAAc,KAAKJ,OAAL,CAAaY,cAAb,EAAd;;EACA,WAAKb,aAAL,GAAqB,KAAKD,IAAL,CAAUe,MAAV,CAAiB,KAAKnB,IAAtB,EAA2BS,OAA3B,CAArB;EACD,KAVM,CAAP;EAWD;;EAEDW,EAAAA,OAAO,GAAI;EACT,SAAKf,aAAL,CAAmBgB,KAAnB;EACD;;EAzBQ;;EA4BbC,MAAM,CAACC,OAAP,GAAiBzB,MAAjB;;;;;;"}